/*!
 * @license @pangenerator/utils v2.7.0, Copyright © 2023 panGenerator
 * Released under MIT license
 * https://github.com/panGenerator/utils#readme
 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t="undefined"!=typeof globalThis?globalThis:t||self).utils=e()}(this,(function(){"use strict";const t=(t,e,n)=>t+(e-t)*n,e=(e,n,s)=>({x:t(e.x,n.x,s),y:t(e.y,n.y,s),z:t(e.z,n.z,s)}),n=t=>t*t,s=t=>{const e=Array(t.length);for(let n=0;n<t.length;n++)e[n]=t[n];return e},o={"Ą":"A","Ć":"C","Ę":"E","Ł":"L","Ń":"N","Ó":"O","Ś":"S","Ź":"Z","Ż":"Z","ą":"a","ć":"c","ę":"e","ł":"l","ń":"n","ó":"o","ś":"s","ź":"z","ż":"z"},r=t=>t.replace(/([ĄĆĘŁŃÓŚŹŻąćęłńóśźż])/g,(function(t){return o[t]})),a=(t,e)=>n(e.x-t.x)+n(e.y-t.y)+(void 0!==t.z&&void 0!==e.z?n(e.z-t.z):0),l=(t,e,n)=>{const s=a(e,n);if(0===s)return a(t,e);const o=((t.x-e.x)*(n.x-e.x)+(t.y-e.y)*(n.y-e.y))/s;return a(t,o<0?e:o>1?n:{x:e.x+o*(n.x-e.x),y:e.y+o*(n.y-e.y)})},i=(t,e="-")=>r(t).replace(/[A-Z]/g,((t,n)=>{const s=t.toLowerCase();return n?e+s:s})).replace(/([-_ ]){1,}/g,e),c=(t,e)=>-1!==e.indexOf(t),g=t=>{const e=[];e.push("#"+t.id);for(let n=0;n<t.classList.length;n++)c("."+t.classList[n],e)||e.push("."+t.classList[n]);const n=t.getElementsByTagName("*");for(let t=0;t<n.length;t++){const s=n[t].id;c("#"+s,e)||e.push("#"+s);const o=n[t].classList;for(let t=0;t<o.length;t++)c("."+o[t],e)||e.push("."+o[t])}let s="";for(let t=0;t<document.styleSheets.length;t++){var o=document.styleSheets[t];try{if(!o.cssRules)continue}catch(t){if("SecurityError"!==t.name)throw t;continue}for(var r=o.cssRules,a=0;a<r.length;a++)c(r[a].selectorText,e)&&(s+=r[a].cssText)}return s},d=(t,e)=>{var n=document.createElement("style");n.setAttribute("type","text/css"),n.innerHTML=t;var s=e.hasChildNodes()?e.children[0]:null;e.insertBefore(n,s)};var u={TweakpaneSettings:class{constructor(t,e,n=null,s=null){this.settingsName=n??t.title+"-settings",this.ctrl=t,e.forEach(((e,n)=>{const s=e.settings.name?t.addFolder({title:e.settings.name}):t;"controls"in e.settings&&Object.keys(e.settings.controls).forEach((t=>{const n=this.shallowCopyExcluding(e.settings.controls[t],"val");n.presetKey=e.settings.prefix?e.settings.prefix+"_"+t:null,n.label=n.label?n.label:t,Object.defineProperty(e,"$"+t,{get:()=>e.settings.controls[t].val,set:n=>{e.settings.controls[t].val=n}});const o=s.addInput(e,"$"+t,n);n.callback&&o.on("change",(t=>{n.callback(t)}))})),"buttons"in e.settings&&Object.keys(e.settings.buttons).forEach((t=>{s.addButton({title:e.settings.buttons[t].label}).on("click",(()=>{e.settings.buttons[t].callback()}))})),"buttons_grid"in e.settings&&e.settings.buttons_grid.grids.forEach((t=>{s.addBlade({view:"buttongrid",size:t.size,label:t.label,cells:t.cells}).on("click",(e=>{t.callbacks[e.index[1]][e.index[0]]()}))})),"monitors"in e.settings&&Object.keys(e.settings.monitors).forEach((t=>{const n=e.settings.monitors_options[t];s.addMonitor(e.settings.monitors,t,n),Object.defineProperty(e,"$"+t,{get:()=>e.settings.monitors[t],set:n=>{e.settings.monitors[t]=n}})}))})),this.default_settings=s??JSON.stringify(t.exportPreset());const o=t.addFolder({title:"presets",expanded:!1});o.addButton({title:"Store settings"}).on("click",(()=>{console.log("save settings");const e=t.exportPreset();localStorage.setItem(n,JSON.stringify(e)),console.log(e),console.log("json:\n",JSON.stringify(e))})),o.addButton({title:"Restore settings"}).on("click",(()=>{this.loadSettings()})),o.addButton({title:"Download settings"}).on("click",(()=>{console.log("download settings");const e=n+"_"+(new Date).toLocaleString().replace(/[^0-9]+/g,"-")+".json",s="data:text/json;charset=utf-8,"+encodeURIComponent(JSON.stringify(t.exportPreset(),null,2)),o=document.createElement("a");o.download=e,o.href=s,o.click(),o.remove()})),o.addButton({title:"Upload settings"}).on("click",(()=>{console.log("upload settings");const e=document.createElement("input");e.setAttribute("type","file"),e.setAttribute("accept","application/json"),e.style.opacity="0",e.style.position="fixed",document.body.appendChild(e),e.addEventListener("input",(n=>{if(e.files&&e.files[0]){const n=e.files[0];let s=new FileReader;s.readAsText(n),s.onload=()=>{console.log("settings loaded..."),console.log(s.result),t.importPreset(JSON.parse(s.result))},s.onerror=()=>{console.log("error loading file!"),console.log(s.error)}}document.body.removeChild(e)}),{once:!0}),e.click()})),o.addButton({title:"Default settings"}).on("click",(()=>{console.log("reset settings to default:",s),t.importPreset(JSON.parse(s))}))}loadSettings(){console.log("restore settings");const t=JSON.parse(localStorage.getItem(this.settingsName));t?(console.log("loaded settings from local storage:",t),this.ctrl.importPreset(t)):(console.log("loaded default settings:",this.default_settings),this.ctrl.importPreset(this.default_settings))}shallowCopyExcluding(t,e){const{[e]:n,...s}=t;return s}},map:(t,e,n,s,o)=>s+(o-s)*(t-e)/(n-e),clamp:(t,e,n)=>t>n?n:t<e?e:t,random:(t,e)=>(void 0===e&&(e=t,t=0),t+Math.random()*(e-t)),randomDir:()=>Math.random()>.5?1:-1,lerp:t,lerp3:e,lerpedPoints:(t,n,s)=>{const o=[],r=1/(s+1);for(let a=0;a<s;a++)o.push(e(t,n,r+r*a));return o},square:n,dist:(t,e)=>Math.sqrt(a(t,e)),norm:(t,e,n)=>(t-e)/(n-e),degrees:t=>180*t/Math.PI,radians:t=>t*Math.PI/180,intersection:(t,e)=>{const n=e.x-t.x,s=e.y-t.y,o=Math.sqrt(s*s+n*n);if(o>t.r+e.r)return!1;if(o<Math.abs(t.r-e.r))return!1;const r=(t.r*t.r-e.r*e.r+o*o)/(2*o),a=t.x+n*r/o,l=t.y+s*r/o,i=Math.sqrt(t.r*t.r-r*r),c=i/o*-s,g=n*(i/o);return[{x:a+c,y:l+g},{x:a-c,y:l-g}]},randomName:t=>(Math.random().toString(36)+"00000000000000000").slice(2,t+2),timestampName:()=>{var t=6e4*(new Date).getTimezoneOffset();let e=new Date(Date.now()-t).toISOString().replace(/z|t/gi," ").trim().replace(/:/gi,"-");return e=e.substring(0,e.indexOf(".")),e},randomIndex:t=>Math.floor(Math.random()*t),copyArray:s,shuffleArray:t=>{const e=s(t);for(let t=e.length-1;t>0;t--){const n=Math.floor(Math.random()*(t+1));[e[t],e[n]]=[e[n],e[t]]}return e},filterUnique:t=>[...new Set(t)],lerpColor:(t,e,n)=>{var s=parseInt(t.replace(/#/g,""),16),o=s>>16,r=s>>8&255,a=255&s,l=parseInt(e.replace(/#/g,""),16);return"#"+((1<<24)+(o+n*((l>>16)-o)<<16)+(r+n*((l>>8&255)-r)<<8)+(a+n*((255&l)-a))|0).toString(16).slice(1)},precision:(t,e)=>Math.round(t*Math.pow(10,e))/Math.pow(10,e),loadJSON:(t,e)=>{const n=new XMLHttpRequest;n.overrideMimeType("application/json"),n.open("GET",t,!0),n.onreadystatechange=()=>{4===n.readyState&&200===n.status&&e(JSON.parse(n.responseText))},n.send(null)},removeDiacritics:r,removeNonAlphaNumeric:t=>t.replace(/[^A-Za-z0-9]/g,""),splitChunks:(t,e,n)=>{const s=t.split(new RegExp("(.{"+e.toString()+"})"));return n?s.filter((t=>t.length===e)):s.filter((t=>t.length>0))},getQuarter:t=>[(t=t||new Date).getFullYear(),Math.floor(t.getMonth()/3)+1],quarterExtent:(t,e)=>[new Date(`${e}-${(3*(t-1)+1).toString().padStart(2,"0")}-01`),new Date(`${e}-${(3*t).toString().padStart(2,"0")}-${1===t||4===t?31:30}`)],downloadDataUri:t=>{var e=document.createElement("a");e.setAttribute("href",t.data),e.setAttribute("download",t.filename),e.style.display="none",document.body.appendChild(e),e.click(),document.body.removeChild(e)},polarToCartesian:(t,e)=>({x:t*Math.cos(e),y:t*Math.sin(e)}),cartesianToPolar:(t,e)=>{let n=Math.atan2(e,t);if(n<0)for(;n<0;)n+=2*Math.PI;if(n>=2*Math.PI)for(;n>=Math.PI;)n-=2*Math.PI;return{r:Math.sqrt(t*t+e*e),angle:n}},pageOffset:t=>{const e=t.getBoundingClientRect(),n=t.ownerDocument.defaultView;return{top:e.top+n.pageYOffset,left:e.left+n.pageXOffset}},fuzzySearch:(t,e)=>{const n=".*"+e.replace(/(.)/g,"$1.*").toLowerCase();var s=new RegExp(n);return t.filter((t=>s.test(t.toLowerCase())))},dist2:a,distToSegment2:l,distToSegment:(t,e,n)=>Math.sqrt(l(t,e,n)),sepCase:i,snakeCase:t=>i(t,"_"),kebabCase:t=>i(t,"-"),camelCase:t=>{const e=r(t);return(e.slice(0,1).toLowerCase()+e.slice(1)).replace(/([-_ ]){1,}/g," ").split(/[-_ ]/).reduce(((t,e)=>t+e[0].toUpperCase()+e.substring(1)))},contains:c,getCSS:g,appendCSS:d,getSVGString:t=>{t.setAttribute("xlink","http://www.w3.org/1999/xlink");var e=g(t);d(e,t);var n=(new XMLSerializer).serializeToString(t);return n=(n=n.replace(/(\w+)?:?xlink=/g,"xmlns:xlink=")).replace(/NS\d+:href/g,"xlink:href")},svgStringToImage:(t,e,n,s,o,r)=>{var a="data:image/svg+xml;base64,"+btoa(unescape(encodeURIComponent(t))),l=document.createElement("canvas"),i=l.getContext("2d");l.width=e,l.height=n;var c=new Image;c.onload=()=>{i.clearRect(0,0,e,n),o||(i.beginPath(),i.fillStyle="#fff",i.fillRect(0,0,l.width,l.height)),i.drawImage(c,0,0,e,n),r&&r(l.toDataURL())},c.src=a},svgToUri:t=>{let e=(new XMLSerializer).serializeToString(t);return e.match(/^<svg[^>]+xmlns="http:\/\/www\.w3\.org\/2000\/svg"/)||(e=e.replace(/^<svg/,'<svg xmlns="http://www.w3.org/2000/svg"')),e.match(/^<svg[^>]+"http:\/\/www\.w3\.org\/1999\/xlink"/)||(e=e.replace(/^<svg/,'<svg xmlns:xlink="http://www.w3.org/1999/xlink"')),e='<?xml version="1.0" standalone="no"?>\r\n'+e,"data:image/svg+xml;charset=utf-8,"+encodeURIComponent(e)},shallowCopyExcluding:(t,e)=>{const{[e]:n,...s}=t;return s}};return u}));
